/* ========================================================
   Signal Brief Engine — Component Styles
   ======================================================== */

/* ===== Global Reset ===== */
* { box-sizing: border-box; }

body {
  font-family: var(--sb-font-ui);
  font-size: var(--sb-text-base);
  color: var(--sb-text-primary);
  background: var(--sb-bg-primary);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ===== Navigation ===== */
.sb-nav {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--sb-bg-secondary);
  border-bottom: 1px solid var(--sb-border);
  padding: var(--sb-space-2) 0;
  backdrop-filter: blur(12px);
}

.sb-nav__inner {
  max-width: var(--sb-max-width);
  margin: 0 auto;
  padding: 0 var(--sb-space-4);
  display: flex;
  align-items: center;
  gap: var(--sb-space-6);
}

.sb-nav__brand {
  font-weight: var(--sb-weight-bold);
  font-size: var(--sb-text-lg);
  color: var(--sb-text-primary);
  text-decoration: none;
  letter-spacing: -0.03em;
  white-space: nowrap;
}

.sb-nav__tabs {
  display: flex;
  gap: var(--sb-space-1);
  list-style: none;
  margin: 0;
  padding: 0;
  overflow-x: auto;
  scrollbar-width: none;
}
.sb-nav__tabs::-webkit-scrollbar { display: none; }

.sb-nav__tabs a {
  display: block;
  padding: var(--sb-space-2) var(--sb-space-3);
  color: var(--sb-text-muted);
  text-decoration: none;
  font-size: var(--sb-text-sm);
  font-weight: var(--sb-weight-medium);
  border-radius: var(--sb-radius-md);
  transition: color var(--sb-transition-fast), background var(--sb-transition-fast);
  white-space: nowrap;
}
.sb-nav__tabs a:hover {
  color: var(--sb-text-primary);
  background: var(--sb-bg-surface);
}
.sb-nav__tabs a.active {
  color: var(--sb-text-primary);
  background: var(--sb-bg-surface);
}

.sb-nav__right {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
}

/* Theme toggle */
.sb-theme-toggle {
  background: none;
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-md);
  padding: var(--sb-space-1) var(--sb-space-2);
  cursor: pointer;
  color: var(--sb-text-muted);
  font-size: var(--sb-text-sm);
  transition: color var(--sb-transition-fast), border-color var(--sb-transition-fast);
  display: flex;
  align-items: center;
  gap: var(--sb-space-1);
}
.sb-theme-toggle:hover {
  color: var(--sb-text-primary);
  border-color: var(--sb-text-muted);
}

/* ===== Main Content ===== */
.sb-main {
  max-width: var(--sb-max-width);
  margin: 0 auto;
  padding: var(--sb-space-8) var(--sb-space-4);
}

/* ===== Welcome Note ===== */
.sb-welcome-note {
  background: linear-gradient(135deg, var(--sb-bg-card) 0%, var(--sb-bg-surface) 100%);
  border: 1px solid var(--sb-accent);
  border-radius: var(--sb-radius-lg);
  padding: var(--sb-space-4) var(--sb-space-5);
  margin-bottom: var(--sb-space-6);
  display: flex;
  align-items: flex-start;
  gap: var(--sb-space-3);
  animation: sb-slide-up 0.3s ease both;
}
.sb-welcome-note__content {
  flex: 1;
  font-size: var(--sb-text-sm);
  color: var(--sb-text-secondary);
  line-height: 1.6;
}
.sb-welcome-note__items {
  display: flex;
  flex-direction: column;
  gap: var(--sb-space-1);
  margin-top: var(--sb-space-2);
  font-size: var(--sb-text-xs);
  color: var(--sb-text-muted);
}
.sb-welcome-note__items strong {
  color: var(--sb-accent);
}
.sb-welcome-note__close {
  background: none;
  border: none;
  color: var(--sb-text-muted);
  cursor: pointer;
  font-size: 18px;
  padding: 0;
  line-height: 1;
  flex-shrink: 0;
}
.sb-welcome-note__close:hover {
  color: var(--sb-text-primary);
}

/* ===== Brief Header ===== */
.sb-brief-header {
  margin-bottom: var(--sb-space-8);
}
.sb-brief-header__date {
  font-size: var(--sb-text-3xl);
  font-weight: var(--sb-weight-bold);
  letter-spacing: -0.04em;
  margin: 0 0 var(--sb-space-2) 0;
  line-height: 1.15;
}
.sb-brief-header__meta {
  font-size: var(--sb-text-sm);
  color: var(--sb-text-muted);
  display: flex;
  gap: var(--sb-space-4);
  flex-wrap: wrap;
}
.sb-brief-header__meta span {
  display: flex;
  align-items: center;
  gap: var(--sb-space-1);
}
.sb-brief-header__clocks {
  display: flex;
  gap: var(--sb-space-5);
  margin-bottom: var(--sb-space-2);
}
.sb-clock {
  font-family: var(--sb-font-ui);
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-muted);
  letter-spacing: -0.02em;
  line-height: 1.2;
}
.sb-brief-header__headlines {
  display: flex;
  flex-wrap: wrap;
  gap: var(--sb-space-2);
  margin-top: var(--sb-space-3);
}
.sb-brief-header__headline {
  display: inline-flex;
  align-items: center;
  gap: var(--sb-space-2);
  font-size: var(--sb-text-sm);
  color: var(--sb-text-secondary);
  padding: var(--sb-space-1) var(--sb-space-3);
  background: var(--sb-bg-card);
  border-radius: var(--sb-radius-md);
  border: 1px solid var(--sb-border-subtle);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 360px;
}
.sb-brief-header__headline-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  flex-shrink: 0;
  background: var(--sb-accent);
}
.sb-brief-header__headline-dot--positive { background: var(--sb-positive); }
.sb-brief-header__headline-dot--negative { background: var(--sb-negative); }
.sb-brief-header__headline-dot--neutral { background: var(--sb-text-muted); }

/* ===== Top Strip (Weather + Market) ===== */
.sb-top-strip {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--sb-space-4);
  margin-bottom: var(--sb-space-6);
}

/* ===== Section Nav ===== */
.sb-section-nav {
  display: flex;
  gap: var(--sb-space-1);
  margin-bottom: var(--sb-space-8);
  padding-bottom: var(--sb-space-3);
  border-bottom: 1px solid var(--sb-border);
  overflow-x: auto;
  scrollbar-width: none;
}
.sb-section-nav::-webkit-scrollbar { display: none; }

.sb-section-nav__item {
  padding: var(--sb-space-2) var(--sb-space-4);
  color: var(--sb-text-muted);
  text-decoration: none;
  font-size: var(--sb-text-sm);
  font-weight: var(--sb-weight-semibold);
  border-radius: var(--sb-radius-md);
  white-space: nowrap;
  transition: color var(--sb-transition-fast), background var(--sb-transition-fast);
}
.sb-section-nav__item:hover,
.sb-section-nav__item.is-active {
  color: var(--sb-text-primary);
  background: var(--sb-bg-surface);
}

/* ===== Section Heading ===== */
.sb-section {
  margin-bottom: var(--sb-space-12);
}
.sb-section__title {
  font-size: var(--sb-text-xl);
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-primary);
  margin: 0 0 var(--sb-space-5) 0;
  padding-bottom: var(--sb-space-3);
  letter-spacing: -0.02em;
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
}
.sb-section__badge {
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-muted);
  background: var(--sb-bg-surface);
  padding: 3px var(--sb-space-3);
  border-radius: var(--sb-radius-full);
}

/* ===== Section Header with Stack Controls ===== */
.sb-section__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--sb-space-5);
}
.sb-section__header .sb-section__title {
  margin: 0;
  padding-bottom: 0;
}

/* Stack controls: counter + nav buttons */
.sb-stack-controls {
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
  flex-shrink: 0;
}
.sb-stack-counter {
  font-size: var(--sb-text-sm);
  color: var(--sb-text-muted);
  font-variant-numeric: tabular-nums;
  min-width: 3.5em;
  text-align: center;
}
.sb-stack-counter__current {
  color: var(--sb-text-primary);
  font-weight: var(--sb-weight-semibold);
}
.sb-stack-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border-radius: var(--sb-radius-md);
  border: 1px solid var(--sb-border);
  background: var(--sb-bg-surface);
  color: var(--sb-text-secondary);
  cursor: pointer;
  transition: all var(--sb-transition-fast);
}
.sb-stack-btn:hover:not(:disabled) {
  background: var(--sb-bg-surface-raised);
  color: var(--sb-text-primary);
  border-color: var(--sb-text-muted);
}
.sb-stack-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}
.sb-stack-btn--reset {
  margin-left: var(--sb-space-1);
}

/* ===== Card Stack Container ===== */
.sb-card-stack {
  position: relative;
  /* Height is set dynamically by JS, fallback to a reasonable min */
  min-height: 280px;
}

/* Each item in the stack */
.sb-card-stack__item {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1),
              opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: transform, opacity;
}

/* Active card — front of the stack */
.sb-card-stack__item.is-active {
  z-index: 10;
  transform: translateX(0) scale(1);
  opacity: 1;
  pointer-events: auto;
}

/* Queued cards — peeking behind with depth effect */
.sb-card-stack__item.is-queued:nth-child(n) {
  pointer-events: none;
}
.sb-card-stack__item.is-queued {
  z-index: 5;
}

/* 1st card behind: slight inset + shift down — peek visible at bottom */
.sb-card-stack__item.is-active + .sb-card-stack__item.is-queued {
  z-index: 9;
  transform: translateY(10px) scale(0.975);
  opacity: 0.7;
}
.sb-card-stack__item.is-active + .sb-card-stack__item.is-queued .sb-card {
  border-color: rgba(255, 255, 255, 0.1);
}
/* 2nd card behind */
.sb-card-stack__item.is-active + .sb-card-stack__item.is-queued + .sb-card-stack__item.is-queued {
  z-index: 8;
  transform: translateY(20px) scale(0.95);
  opacity: 0.45;
}
.sb-card-stack__item.is-active + .sb-card-stack__item.is-queued + .sb-card-stack__item.is-queued .sb-card {
  border-color: rgba(255, 255, 255, 0.07);
}
/* 3rd card behind */
.sb-card-stack__item.is-active + .sb-card-stack__item.is-queued + .sb-card-stack__item.is-queued + .sb-card-stack__item.is-queued {
  z-index: 7;
  transform: translateY(30px) scale(0.925);
  opacity: 0.25;
}

/* Hidden cards (not in visible stack) */
.sb-card-stack__item.is-hidden {
  z-index: 0;
  transform: translateY(56px) scale(0.88);
  opacity: 0;
  pointer-events: none;
}

/* Swiped-out card — flies off to the left */
.sb-card-stack__item.is-swiped {
  z-index: 1;
  transform: translateX(-110%) rotate(-5deg);
  opacity: 0;
  pointer-events: none;
  transition: transform 0.45s cubic-bezier(0.4, 0, 0.2, 1),
              opacity 0.35s ease;
}

/* Remove the margin on cards inside the stack since they're absolute */
.sb-card-stack .sb-card {
  margin-bottom: 0;
}

/* ===== Cluster Card — Large left image ===== */
.sb-card {
  position: relative;
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-xl);
  margin-bottom: var(--sb-space-4);
  overflow: hidden;
  transition: background var(--sb-transition-fast), box-shadow var(--sb-transition-base), transform var(--sb-transition-fast);
  outline: none;
  display: grid;
  grid-template-columns: 260px 1fr;
  grid-template-rows: 1fr;
  width: 100%;
  box-sizing: border-box;
}
.sb-card:hover {
  background: var(--sb-bg-card-hover);
  box-shadow: var(--sb-shadow-md);
  transform: translateY(-1px);
}
.sb-card:focus-visible {
  box-shadow: 0 0 0 2px var(--sb-accent);
}

/* Square image on the left */
.sb-card__image {
  width: 260px;
  height: 260px;
  object-fit: cover;
  object-position: center;
  display: block;
  background: var(--sb-bg-surface);
  grid-row: 1 / -1;
  border-radius: var(--sb-radius-xl) 0 0 var(--sb-radius-xl);
  aspect-ratio: 1 / 1;
}
.sb-card__image--placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--sb-bg-surface) 0%, var(--sb-bg-surface-raised) 100%);
  color: var(--sb-text-muted);
  font-size: var(--sb-text-2xl);
  opacity: 0.3;
}

/* Card content — right side */
.sb-card__content {
  padding: var(--sb-space-5);
  display: flex;
  flex-direction: column;
  gap: var(--sb-space-3);
  min-width: 0;
}

/* Bias ribbon — 4px left border on the image */
.sb-card::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  z-index: 1;
  background: var(--sb-bias-center);
}
.sb-card--bias-left::before { background: var(--sb-bias-left); }
.sb-card--bias-right::before { background: var(--sb-bias-right); }
.sb-card--bias-center::before { background: var(--sb-bias-center); }

/* Card header — now inside content area */
.sb-card__header {
  cursor: pointer;
}
.sb-card__meta {
  flex: 1;
  min-width: 0;
}
.sb-card__title {
  font-size: var(--sb-text-md);
  font-weight: var(--sb-weight-bold);
  margin: 0 0 var(--sb-space-2) 0;
  line-height: 1.35;
  color: var(--sb-text-primary);
  letter-spacing: -0.01em;
}
.sb-card__indicators {
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
  font-size: var(--sb-text-xs);
  color: var(--sb-text-muted);
}

/* Trust badge */
.sb-trust {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-weight: var(--sb-weight-semibold);
  font-size: var(--sb-text-xs);
}
.sb-trust::before {
  content: '';
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: var(--sb-trust-mid);
}
.sb-trust--high::before { background: var(--sb-trust-high); }
.sb-trust--mid::before { background: var(--sb-trust-mid); }
.sb-trust--low::before { background: var(--sb-trust-low); }

/* Card body — visible by default, collapsed on click */
.sb-card__body {
  padding-top: var(--sb-space-2);
  border-top: 1px solid var(--sb-border-subtle);
}
.sb-card--collapsed .sb-card__body {
  display: none;
}

.sb-card__summary {
  font-family: var(--sb-font-excerpt);
  font-size: var(--sb-text-sm);
  line-height: 1.6;
  color: var(--sb-text-secondary);
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 5;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Grok take (xAI secondary analysis) */
.sb-grok-take {
  display: flex;
  flex-direction: column;
  gap: var(--sb-space-1);
  margin-top: var(--sb-space-2);
  padding: var(--sb-space-2) var(--sb-space-3);
  background: rgba(99, 102, 241, 0.08);
  border-left: 3px solid #6366f1;
  border-radius: 0 var(--sb-radius-md) var(--sb-radius-md) 0;
  font-size: var(--sb-text-xs);
  line-height: 1.5;
}
.sb-grok-take__header {
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
}
.sb-grok-take__label {
  flex-shrink: 0;
  font-weight: var(--sb-weight-bold);
  color: #818cf8;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-size: 10px;
  padding: 1px 6px;
  background: rgba(99, 102, 241, 0.15);
  border-radius: var(--sb-radius-sm);
}
.sb-grok-take__badge {
  font-size: 9px;
  color: var(--sb-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}
.sb-grok-take__text {
  color: var(--sb-text-secondary);
  white-space: pre-line;
}

/* Source badges row */
.sb-card__sources {
  display: flex;
  flex-wrap: wrap;
  gap: var(--sb-space-1);
}

.sb-source-badge {
  display: inline-block;
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-medium);
  color: var(--sb-text-secondary);
  background: var(--sb-bg-surface);
  padding: 3px var(--sb-space-2);
  border-radius: var(--sb-radius-full);
  text-decoration: none;
  transition: background var(--sb-transition-fast), color var(--sb-transition-fast);
  border: 1px solid transparent;
}
.sb-source-badge:hover {
  color: var(--sb-text-primary);
  background: var(--sb-bg-surface-raised);
}
.sb-source-badge--left { border-left: 2px solid var(--sb-bias-left); }
.sb-source-badge--right { border-left: 2px solid var(--sb-bias-right); }
.sb-source-badge--center { border-left: 2px solid var(--sb-bias-center); }

/* Card actions */
.sb-card__actions {
  display: flex;
  gap: var(--sb-space-2);
  padding-top: var(--sb-space-3);
  border-top: 1px solid var(--sb-border-subtle);
}

.sb-action-btn {
  background: none;
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-md);
  padding: var(--sb-space-1) var(--sb-space-3);
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-medium);
  color: var(--sb-text-muted);
  cursor: pointer;
  transition: all var(--sb-transition-fast);
  display: inline-flex;
  align-items: center;
  gap: 5px;
}
.sb-action-btn:hover {
  color: var(--sb-text-primary);
  border-color: var(--sb-text-muted);
  background: var(--sb-bg-surface);
}
.sb-action-btn.is-active {
  color: var(--sb-accent);
  border-color: var(--sb-accent);
  background: var(--sb-accent-subtle);
}
.sb-action-btn--upvote.is-active { color: var(--sb-positive); border-color: var(--sb-positive); }
.sb-action-btn--downvote.is-active { color: var(--sb-negative); border-color: var(--sb-negative); }

/* Responsive: stack on mobile */
@media (max-width: 640px) {
  .sb-card {
    grid-template-columns: 1fr;
  }
  .sb-card__image {
    width: 100%;
    height: 180px;
    aspect-ratio: auto;
    grid-row: auto;
    border-radius: var(--sb-radius-xl) var(--sb-radius-xl) 0 0;
  }
}

/* ===== Weather Card — Compact Animated ===== */
.sb-weather {
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-xl);
  padding: var(--sb-space-4) var(--sb-space-5);
  width: 100%;
  box-sizing: border-box;
}
.sb-weather__title {
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin: 0 0 var(--sb-space-3) 0;
}
.sb-weather__grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--sb-space-3);
}

.sb-weather__location {
  padding: var(--sb-space-3) var(--sb-space-4);
  border-radius: var(--sb-radius-lg);
  background: var(--sb-bg-surface);
  transition: all 0.2s ease;
  min-width: 0;
}
.sb-weather__location:hover {
  background: var(--sb-bg-surface-raised);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}
.sb-weather__location--primary {
  background: linear-gradient(135deg, var(--sb-accent-subtle), var(--sb-bg-surface));
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.sb-weather__main {
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
}

.sb-weather__icon-wrap {
  flex-shrink: 0;
  width: 56px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.sb-weather__svg {
  width: 52px;
  height: 52px;
}
.sb-weather__svg--sun { animation: sb-weather-glow 3s ease-in-out infinite; }
.sb-weather__svg--partial { animation: sb-weather-float 4s ease-in-out infinite; }
.sb-weather__svg--cloud { animation: sb-weather-drift 5s ease-in-out infinite; }
.sb-weather__svg--rain { animation: sb-weather-float 3s ease-in-out infinite; }
.sb-weather__svg--snow { animation: sb-weather-float 4s ease-in-out infinite; }
.sb-weather__svg--thunder .sb-weather__bolt { animation: sb-weather-flash 2s ease-in-out infinite; }
.sb-weather__svg--fog { animation: sb-weather-drift 6s ease-in-out infinite; }

.sb-weather__raindrops { animation: sb-weather-rain 1.5s ease-in infinite; }
.sb-weather__snowflakes { animation: sb-weather-snow 2s ease-in-out infinite; }

.sb-weather__info {
  min-width: 0;
}

.sb-weather__city {
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 2px;
}

.sb-weather__temp {
  font-size: var(--sb-text-2xl);
  font-weight: var(--sb-weight-bold);
  letter-spacing: -0.03em;
  line-height: 1.1;
}
.sb-weather__temp-hi {
  color: var(--sb-text-primary);
}
.sb-weather__temp-lo {
  color: var(--sb-text-muted);
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-medium);
}

.sb-weather__condition {
  font-size: var(--sb-text-sm);
  color: var(--sb-text-muted);
  margin-top: 2px;
}

.sb-weather__forecast {
  display: flex;
  gap: var(--sb-space-3);
  margin-top: var(--sb-space-3);
  padding-top: var(--sb-space-2);
  border-top: 1px solid var(--sb-border-subtle);
  align-items: center;
}
.sb-weather__forecast-day {
  display: flex;
  align-items: center;
  gap: var(--sb-space-1);
  color: var(--sb-text-muted);
}
.sb-weather__mini-svg {
  width: 20px;
  height: 20px;
  vertical-align: middle;
}
.sb-weather__forecast-day-temp {
  font-weight: var(--sb-weight-semibold);
  font-size: var(--sb-text-sm);
  color: var(--sb-text-secondary);
}

/* Weather animations */
@keyframes sb-weather-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-3px); }
}
@keyframes sb-weather-drift {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(3px); }
}
@keyframes sb-weather-glow {
  0%, 100% { filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.3)); }
  50% { filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.6)); }
}
@keyframes sb-weather-flash {
  0%, 85%, 100% { opacity: 1; }
  90%, 95% { opacity: 0.2; }
}
@keyframes sb-weather-rain {
  0% { transform: translateY(0); opacity: 1; }
  80% { opacity: 1; }
  100% { transform: translateY(4px); opacity: 0; }
}
@keyframes sb-weather-snow {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(3px); }
}

/* ===== Market Mini Strip ===== */
.sb-market-strip {
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-xl);
  padding: var(--sb-space-4) var(--sb-space-5);
}
.sb-market-strip__title {
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin: 0 0 var(--sb-space-3) 0;
}
.sb-market-strip__grid {
  display: flex;
  gap: var(--sb-space-5);
  overflow-x: auto;
  scrollbar-width: none;
}
.sb-market-strip__grid::-webkit-scrollbar { display: none; }

.sb-market-item {
  flex-shrink: 0;
  min-width: 0;
}
.sb-market-item__symbol {
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-muted);
}
.sb-market-item__price {
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-bold);
  letter-spacing: -0.02em;
}
.sb-market-item__change {
  font-size: var(--sb-text-sm);
  font-weight: var(--sb-weight-bold);
}
.sb-market-item__change--positive { color: var(--sb-positive); }
.sb-market-item__change--negative { color: var(--sb-negative); }
.sb-market-item__change--neutral { color: var(--sb-neutral); }

/* ===== Thesis Card ===== */
.sb-thesis {
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-xl);
  padding: var(--sb-space-8);
  margin-top: var(--sb-space-8);
}
.sb-thesis__header {
  display: flex;
  align-items: center;
  gap: var(--sb-space-4);
  margin-bottom: var(--sb-space-5);
}
.sb-thesis__title {
  font-size: var(--sb-text-xl);
  font-weight: var(--sb-weight-bold);
  margin: 0;
  letter-spacing: -0.02em;
}
.sb-thesis__gate {
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-bold);
  padding: var(--sb-space-1) var(--sb-space-3);
  border-radius: var(--sb-radius-full);
  display: inline-flex;
  align-items: center;
  gap: var(--sb-space-1);
}
.sb-thesis__gate--pass {
  background: rgba(34, 197, 94, 0.12);
  color: var(--sb-positive);
}
.sb-thesis__gate--fail {
  background: rgba(239, 68, 68, 0.12);
  color: var(--sb-negative);
}
.sb-thesis__text {
  font-family: var(--sb-font-excerpt);
  font-size: var(--sb-text-base);
  line-height: 1.8;
  color: var(--sb-text-secondary);
  margin: 0 0 var(--sb-space-5) 0;
}
.sb-thesis__signals {
  display: flex;
  gap: var(--sb-space-5);
  font-size: var(--sb-text-sm);
  color: var(--sb-text-muted);
}
.sb-thesis__signal {
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
}

/* ===== Cost Gauge ===== */
.sb-gauge {
  background: var(--sb-bg-surface);
  border-radius: var(--sb-radius-full);
  height: 8px;
  overflow: hidden;
  margin: var(--sb-space-2) 0;
}
.sb-gauge__fill {
  height: 100%;
  border-radius: var(--sb-radius-full);
  background: var(--sb-accent);
  transition: width var(--sb-transition-slow);
}
.sb-gauge__fill--warning { background: var(--sb-trust-mid); }
.sb-gauge__fill--danger { background: var(--sb-negative); }

/* ===== Empty State ===== */
.sb-empty {
  text-align: center;
  padding: var(--sb-space-16) var(--sb-space-4);
  color: var(--sb-text-muted);
}
.sb-empty__icon {
  font-size: 3rem;
  margin-bottom: var(--sb-space-5);
  opacity: 0.35;
}
.sb-empty__title {
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-secondary);
  margin: 0 0 var(--sb-space-2) 0;
}
.sb-empty__text {
  font-size: var(--sb-text-base);
  color: var(--sb-text-muted);
  margin: 0;
}

/* ===== Settings Page ===== */
.sb-settings-tabs {
  display: flex;
  gap: var(--sb-space-1);
  margin-bottom: var(--sb-space-8);
  border-bottom: 1px solid var(--sb-border);
}
.sb-settings-tabs__item {
  padding: var(--sb-space-3) var(--sb-space-5);
  color: var(--sb-text-muted);
  text-decoration: none;
  font-size: var(--sb-text-base);
  font-weight: var(--sb-weight-medium);
  border-bottom: 2px solid transparent;
  margin-bottom: -1px;
  transition: color var(--sb-transition-fast);
}
.sb-settings-tabs__item.is-active,
.sb-settings-tabs__item:target {
  color: var(--sb-text-primary);
  border-bottom-color: var(--sb-accent);
}

.sb-source-row {
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
  padding: var(--sb-space-3) 0;
  border-bottom: 1px solid var(--sb-border-subtle);
  font-size: var(--sb-text-sm);
}
.sb-source-row__name { flex: 1; font-weight: var(--sb-weight-medium); }
.sb-source-row__section { color: var(--sb-text-muted); font-size: var(--sb-text-xs); }

/* ===== History Table ===== */
.sb-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: var(--sb-text-sm);
}
.sb-table th {
  text-align: left;
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-muted);
  font-size: var(--sb-text-xs);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  padding: var(--sb-space-3) var(--sb-space-3);
  border-bottom: 1px solid var(--sb-border);
}
.sb-table td {
  padding: var(--sb-space-3);
  border-bottom: 1px solid var(--sb-border-subtle);
  color: var(--sb-text-secondary);
}
.sb-table tr:hover td {
  background: var(--sb-bg-card-hover);
}
.sb-table a {
  color: var(--sb-accent);
  text-decoration: none;
}

/* ===== Stories Timeline ===== */
.sb-timeline {
  position: relative;
  padding-left: var(--sb-space-6);
}
.sb-timeline::before {
  content: '';
  position: absolute;
  left: 11px;
  top: 0;
  bottom: 0;
  width: 2px;
  background: var(--sb-border);
}
.sb-timeline__item {
  position: relative;
  margin-bottom: var(--sb-space-4);
}
.sb-timeline__dot {
  position: absolute;
  left: calc(-1 * var(--sb-space-6) + 6px);
  top: 6px;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--sb-accent);
  border: 2px solid var(--sb-bg-primary);
}
.sb-timeline__content {
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-md);
  padding: var(--sb-space-3);
}
.sb-timeline__date {
  font-size: var(--sb-text-xs);
  color: var(--sb-text-muted);
}

/* ===== Status / Inline Badges ===== */
.sb-badge {
  display: inline-block;
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-bold);
  padding: 3px var(--sb-space-3);
  border-radius: var(--sb-radius-full);
  background: var(--sb-bg-surface);
  color: var(--sb-text-secondary);
}
.sb-badge--success { background: rgba(34,197,94,0.12); color: var(--sb-positive); }
.sb-badge--warning { background: rgba(234,179,8,0.12); color: var(--sb-trust-mid); }
.sb-badge--danger { background: rgba(239,68,68,0.12); color: var(--sb-negative); }

/* ===== Footer ===== */
.sb-footer {
  max-width: var(--sb-max-width);
  margin: 0 auto;
  padding: var(--sb-space-8) var(--sb-space-4);
  text-align: center;
  font-size: var(--sb-text-xs);
  color: var(--sb-text-muted);
  border-top: 1px solid var(--sb-border);
}

/* ===== Sparkline (inline SVG) ===== */
.sb-sparkline {
  display: inline-block;
  vertical-align: middle;
}

/* ===== Keyboard Shortcut Hints ===== */
.sb-kbd {
  display: none;
  font-family: var(--sb-font-mono);
  font-size: 10px;
  padding: 1px 5px;
  border: 1px solid var(--sb-border);
  border-radius: 3px;
  color: var(--sb-text-muted);
  background: var(--sb-bg-surface);
}
.sb-keyboard-user .sb-kbd {
  display: inline-block;
}

/* ===== Animations ===== */
@keyframes sb-fade-in {
  from { opacity: 0; transform: translateY(-4px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes sb-slide-up {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Stagger card entrance animation */
.sb-section .sb-card {
  animation: sb-slide-up 0.35s ease both;
}
.sb-section .sb-card:nth-child(1) { animation-delay: 0s; }
.sb-section .sb-card:nth-child(2) { animation-delay: 0.05s; }
.sb-section .sb-card:nth-child(3) { animation-delay: 0.1s; }
.sb-section .sb-card:nth-child(4) { animation-delay: 0.15s; }
.sb-section .sb-card:nth-child(5) { animation-delay: 0.2s; }
.sb-section .sb-card:nth-child(n+6) { animation-delay: 0.25s; }

/* ===== Page Header (generic) ===== */
.sb-page-header {
  margin-bottom: var(--sb-space-8);
}
.sb-page-title {
  font-size: var(--sb-text-3xl);
  font-weight: var(--sb-weight-bold);
  letter-spacing: -0.04em;
  margin: 0 0 var(--sb-space-2) 0;
  line-height: 1.15;
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
}
.sb-page-subtitle {
  font-size: var(--sb-text-base);
  color: var(--sb-text-muted);
  margin: 0;
}
.sb-back-link {
  color: var(--sb-text-muted);
  text-decoration: none;
  display: flex;
  align-items: center;
  transition: color var(--sb-transition-fast);
  flex-shrink: 0;
}
.sb-back-link:hover { color: var(--sb-text-primary); }

.sb-timeline-header {
  display: flex;
  align-items: flex-start;
  gap: var(--sb-space-4);
}
.sb-timeline-icon {
  font-size: var(--sb-text-2xl);
}

/* ===== Timelines Grid ===== */
.sb-timelines-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(420px, 1fr));
  gap: var(--sb-space-5);
}
@media (max-width: 500px) {
  .sb-timelines-grid {
    grid-template-columns: 1fr;
  }
}

.sb-timeline-card {
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-xl);
  padding: var(--sb-space-6);
  text-decoration: none;
  color: inherit;
  transition: background var(--sb-transition-fast), box-shadow var(--sb-transition-base), transform var(--sb-transition-fast);
  display: flex;
  flex-direction: column;
  gap: var(--sb-space-4);
}
.sb-timeline-card:hover {
  background: var(--sb-bg-card-hover);
  box-shadow: var(--sb-shadow-md);
  transform: translateY(-2px);
}

.sb-timeline-card__header {
  display: flex;
  gap: var(--sb-space-4);
  align-items: flex-start;
}
.sb-timeline-card__icon {
  font-size: 2.2rem;
  line-height: 1;
  flex-shrink: 0;
}
.sb-timeline-card__title-wrap {
  min-width: 0;
}
.sb-timeline-card__title {
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-bold);
  margin: 0 0 var(--sb-space-1) 0;
  line-height: 1.3;
  letter-spacing: -0.02em;
  color: var(--sb-text-primary);
}
.sb-timeline-card__description {
  font-size: var(--sb-text-sm);
  color: var(--sb-text-muted);
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.sb-timeline-card__entities {
  display: flex;
  flex-wrap: wrap;
  gap: var(--sb-space-2);
}

.sb-timeline-card__meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: var(--sb-text-xs);
  color: var(--sb-text-muted);
  padding-top: var(--sb-space-3);
  border-top: 1px solid var(--sb-border-subtle);
}
.sb-timeline-card__count {
  font-weight: var(--sb-weight-semibold);
}

/* ===== Entity Badges & Chips ===== */
.sb-entity-badge {
  display: inline-flex;
  align-items: center;
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-semibold);
  padding: 3px var(--sb-space-3);
  border-radius: var(--sb-radius-full);
  background: color-mix(in srgb, var(--entity-color, #a3a3a3) 12%, transparent);
  color: var(--entity-color, var(--sb-text-secondary));
  border: 1px solid color-mix(in srgb, var(--entity-color, #a3a3a3) 25%, transparent);
}

.sb-entity-filters {
  display: flex;
  flex-wrap: wrap;
  gap: var(--sb-space-2);
  margin-bottom: var(--sb-space-8);
}

.sb-entity-chip {
  display: inline-flex;
  align-items: center;
  padding: var(--sb-space-2) var(--sb-space-4);
  font-size: var(--sb-text-sm);
  font-weight: var(--sb-weight-medium);
  color: var(--sb-text-muted);
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-full);
  text-decoration: none;
  transition: all var(--sb-transition-fast);
}
.sb-entity-chip:hover {
  color: var(--sb-text-primary);
  border-color: var(--sb-text-muted);
  background: var(--sb-bg-surface);
}
.sb-entity-chip--active {
  color: var(--sb-text-primary);
  background: var(--sb-bg-surface);
  border-color: var(--chip-color, var(--sb-accent));
  box-shadow: 0 0 0 1px var(--chip-color, var(--sb-accent));
}

/* ===== Timeline Detail View ===== */
.sb-timeline__month {
  margin-bottom: var(--sb-space-8);
}
.sb-timeline__month-label {
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-primary);
  letter-spacing: -0.02em;
  margin-bottom: var(--sb-space-4);
  padding-bottom: var(--sb-space-2);
  border-bottom: 2px solid var(--sb-border);
  position: sticky;
  top: 48px;
  background: var(--sb-bg-primary);
  z-index: 10;
}

.sb-timeline__events {
  position: relative;
  padding-left: var(--sb-space-8);
}
.sb-timeline__events::before {
  content: '';
  position: absolute;
  left: 15px;
  top: 0;
  bottom: 0;
  width: 2px;
  background: var(--sb-border);
}

.sb-timeline__event {
  position: relative;
  margin-bottom: var(--sb-space-5);
  animation: sb-slide-up 0.3s ease both;
}
.sb-timeline__event:nth-child(1) { animation-delay: 0s; }
.sb-timeline__event:nth-child(2) { animation-delay: 0.03s; }
.sb-timeline__event:nth-child(3) { animation-delay: 0.06s; }
.sb-timeline__event:nth-child(4) { animation-delay: 0.09s; }
.sb-timeline__event:nth-child(5) { animation-delay: 0.12s; }
.sb-timeline__event:nth-child(n+6) { animation-delay: 0.15s; }

.sb-timeline__event-dot {
  position: absolute;
  left: calc(-1 * var(--sb-space-8) + 10px);
  top: 8px;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: 2px solid var(--sb-bg-primary);
  z-index: 2;
  transition: transform var(--sb-transition-fast);
}
.sb-timeline__event:hover .sb-timeline__event-dot {
  transform: scale(1.3);
}

.sb-timeline__event-content {
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-lg);
  padding: var(--sb-space-4) var(--sb-space-5);
  transition: background var(--sb-transition-fast), box-shadow var(--sb-transition-fast);
}
.sb-timeline__event:hover .sb-timeline__event-content {
  background: var(--sb-bg-card-hover);
  box-shadow: var(--sb-shadow-sm);
}

.sb-timeline__event-header {
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
  margin-bottom: var(--sb-space-2);
  flex-wrap: wrap;
}

.sb-timeline__event-date {
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-muted);
  letter-spacing: 0.02em;
}

.sb-entity-tag {
  display: inline-flex;
  align-items: center;
  font-size: 10px;
  font-weight: var(--sb-weight-bold);
  padding: 2px var(--sb-space-2);
  border-radius: var(--sb-radius-sm);
  background: color-mix(in srgb, var(--entity-color, #a3a3a3) 12%, transparent);
  color: var(--entity-color, var(--sb-text-secondary));
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.sb-event-type {
  font-size: 10px;
  font-weight: var(--sb-weight-medium);
  color: var(--sb-text-muted);
  background: var(--sb-bg-surface);
  padding: 2px var(--sb-space-2);
  border-radius: var(--sb-radius-sm);
  text-transform: capitalize;
}

.sb-timeline__event-title {
  font-size: var(--sb-text-base);
  font-weight: var(--sb-weight-semibold);
  margin: 0 0 var(--sb-space-2) 0;
  line-height: 1.4;
  color: var(--sb-text-primary);
}

.sb-timeline__event-summary {
  font-size: var(--sb-text-sm);
  line-height: 1.6;
  color: var(--sb-text-secondary);
  margin: 0;
  font-family: var(--sb-font-excerpt);
}

.sb-timeline__event-sources {
  display: flex;
  gap: var(--sb-space-2);
  margin-top: var(--sb-space-3);
}

.sb-timeline__source-link {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: var(--sb-text-xs);
  color: var(--sb-accent);
  text-decoration: none;
  transition: opacity var(--sb-transition-fast);
}
.sb-timeline__source-link:hover {
  opacity: 0.8;
}

/* High significance events get extra styling */
.sb-timeline__event[data-significance="9"] .sb-timeline__event-content,
.sb-timeline__event[data-significance="10"] .sb-timeline__event-content {
  border-left: 3px solid var(--sb-accent);
}
.sb-timeline__event[data-significance="9"] .sb-timeline__event-title,
.sb-timeline__event[data-significance="10"] .sb-timeline__event-title {
  font-size: var(--sb-text-md);
}

/* ===== Hedge Fund Analysis Signals ===== */
.sb-hf-section {
  max-width: var(--sb-max-width);
}
.sb-hf-overview {
  display: flex;
  gap: var(--sb-space-3);
  flex-wrap: wrap;
  margin-bottom: var(--sb-space-6);
}
.sb-hf-pill {
  display: inline-flex;
  align-items: center;
  gap: var(--sb-space-2);
  padding: var(--sb-space-2) var(--sb-space-4);
  border-radius: var(--sb-radius-full);
  font-size: var(--sb-text-sm);
  font-weight: var(--sb-weight-semibold);
  border: 1px solid var(--sb-border);
  background: var(--sb-bg-card);
  transition: all var(--sb-transition-fast);
}
.sb-hf-pill:hover { background: var(--sb-bg-card-hover); }
.sb-hf-pill--bullish { border-color: var(--sb-positive); background: rgba(34,197,94,0.06); }
.sb-hf-pill--bearish { border-color: var(--sb-negative); background: rgba(239,68,68,0.06); }
.sb-hf-pill--neutral { border-color: var(--sb-trust-mid); background: rgba(234,179,8,0.06); }
.sb-hf-pill__ticker { color: var(--sb-text-primary); font-weight: var(--sb-weight-bold); }
.sb-hf-pill__conf { color: var(--sb-text-muted); font-size: var(--sb-text-xs); }

.sb-hf-card {
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-lg);
  margin-bottom: var(--sb-space-3);
  overflow: hidden;
  transition: box-shadow var(--sb-transition-fast);
}
.sb-hf-card:hover { box-shadow: var(--sb-shadow-sm); }
.sb-hf-card__header {
  display: flex;
  align-items: center;
  gap: var(--sb-space-4);
  padding: var(--sb-space-4) var(--sb-space-5);
  cursor: pointer;
  user-select: none;
}
.sb-hf-card__ticker {
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-primary);
  min-width: 60px;
}
.sb-hf-card__consensus {
  font-weight: var(--sb-weight-bold);
  font-size: var(--sb-text-sm);
  text-transform: capitalize;
}
.sb-hf-card__confidence {
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
  margin-left: auto;
  font-size: var(--sb-text-sm);
  color: var(--sb-text-muted);
}
.sb-hf-card__chevron {
  color: var(--sb-text-muted);
  transition: transform var(--sb-transition-fast);
  flex-shrink: 0;
}
.sb-hf-card--expanded .sb-hf-card__chevron {
  transform: rotate(180deg);
}

.sb-hf-conf-bar {
  width: 80px;
  height: 6px;
  background: var(--sb-bg-surface);
  border-radius: var(--sb-radius-full);
  overflow: hidden;
}
.sb-hf-conf-bar__fill {
  height: 100%;
  border-radius: var(--sb-radius-full);
  transition: width var(--sb-transition-base);
}
.sb-hf-signal-bg--bullish { background: var(--sb-positive); }
.sb-hf-signal-bg--bearish { background: var(--sb-negative); }
.sb-hf-signal-bg--neutral { background: var(--sb-trust-mid); }

.sb-hf-card__body {
  display: none;
  padding: 0 var(--sb-space-5) var(--sb-space-4);
  border-top: 1px solid var(--sb-border-subtle, var(--sb-border));
}
.sb-hf-card--expanded .sb-hf-card__body {
  display: block;
}

.sb-hf-signal--bullish { color: var(--sb-positive); }
.sb-hf-signal--bearish { color: var(--sb-negative); }
.sb-hf-signal--neutral { color: var(--sb-trust-mid); }
.sb-hf-signal--buy, .sb-hf-signal--cover { color: var(--sb-positive); }
.sb-hf-signal--sell, .sb-hf-signal--short { color: var(--sb-negative); }
.sb-hf-signal--hold { color: var(--sb-trust-mid); }

.sb-hf-analyst-row {
  display: grid;
  grid-template-columns: 180px 80px 55px 1fr;
  gap: var(--sb-space-3);
  padding: var(--sb-space-3) 0;
  border-bottom: 1px solid var(--sb-border-subtle, var(--sb-border));
  font-size: var(--sb-text-sm);
  align-items: start;
}
.sb-hf-analyst-row:last-child { border-bottom: none; }
.sb-hf-analyst-row__name {
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-primary);
}
.sb-hf-analyst-row__signal {
  font-weight: var(--sb-weight-bold);
  text-transform: capitalize;
}
.sb-hf-analyst-row__conf {
  color: var(--sb-text-muted);
  font-family: var(--sb-font-mono);
  font-size: var(--sb-text-xs);
}
.sb-hf-analyst-row__reasoning {
  color: var(--sb-text-muted);
  font-size: var(--sb-text-xs);
  line-height: 1.6;
}

/* Formatted reasoning sub-lines */
.sb-hf-reasoning-line {
  display: flex;
  align-items: baseline;
  gap: var(--sb-space-1);
  padding: 1px 0;
  flex-wrap: wrap;
}
.sb-hf-reasoning-line--summary {
  margin-top: 2px;
  padding-top: 2px;
  border-top: 1px solid var(--sb-border);
}
.sb-hf-reasoning-label {
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-secondary);
  white-space: nowrap;
  min-width: 70px;
}
.sb-hf-reasoning-detail {
  color: var(--sb-text-muted);
  font-family: var(--sb-font-mono);
  font-size: 0.68rem;
}

.sb-hf-decision {
  margin-top: var(--sb-space-4);
  padding-top: var(--sb-space-3);
  border-top: 1px solid var(--sb-border);
  font-size: var(--sb-text-sm);
  display: flex;
  gap: var(--sb-space-2);
  align-items: baseline;
  flex-wrap: wrap;
}
.sb-hf-decision__label {
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-secondary);
}
.sb-hf-decision__reasoning {
  color: var(--sb-text-muted);
  font-size: var(--sb-text-xs);
}

.sb-hf-disclaimer {
  margin-top: var(--sb-space-4);
  font-size: var(--sb-text-xs);
  color: var(--sb-text-muted);
  font-style: italic;
  text-align: center;
}

@media (max-width: 768px) {
  .sb-hf-analyst-row {
    grid-template-columns: 1fr;
    gap: var(--sb-space-1);
  }
  .sb-hf-analyst-row__reasoning {
    margin-top: var(--sb-space-1);
  }
}

/* ===== Market Performance Table ===== */
.sb-market-table-wrap {
  overflow-x: auto;
  margin-bottom: var(--sb-space-8);
  border-radius: var(--sb-radius-xl);
  border: 1px solid var(--sb-border);
  background: var(--sb-bg-card);
}
.sb-market-table {
  width: 100%;
  border-collapse: collapse;
  font-size: var(--sb-text-sm);
}
.sb-market-table thead tr {
  background: var(--sb-bg-surface);
}
.sb-market-table th {
  text-align: left;
  font-weight: var(--sb-weight-bold);
  color: var(--sb-text-muted);
  font-size: var(--sb-text-xs);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  padding: var(--sb-space-3) var(--sb-space-4);
  border-bottom: 1px solid var(--sb-border);
  white-space: nowrap;
}
.sb-market-table__change-col {
  text-align: right;
}
.sb-market-table__row {
  transition: background var(--sb-transition-fast);
}
.sb-market-table__row:hover {
  background: var(--sb-bg-card-hover);
}
.sb-market-table__row td {
  padding: var(--sb-space-3) var(--sb-space-4);
  border-bottom: 1px solid var(--sb-border-subtle);
  vertical-align: middle;
}
.sb-market-table__row:last-child td {
  border-bottom: none;
}
.sb-market-table__name {
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-primary);
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
  white-space: nowrap;
}
.sb-market-table__symbol-icon {
  width: 28px;
  height: 28px;
  border-radius: var(--sb-radius-md);
  background: var(--sb-bg-surface);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: var(--sb-weight-bold);
  font-size: var(--sb-text-xs);
  color: var(--sb-text-muted);
  flex-shrink: 0;
}
.sb-market-table__price {
  font-weight: var(--sb-weight-bold);
  font-variant-numeric: tabular-nums;
  letter-spacing: -0.02em;
}
.sb-market-table__change {
  text-align: right;
  min-width: 140px;
}

/* Performance cell with inline bar */
.sb-perf-cell {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
}
.sb-perf-cell__value {
  font-weight: var(--sb-weight-bold);
  font-variant-numeric: tabular-nums;
  font-size: var(--sb-text-sm);
}
.sb-perf-cell--positive .sb-perf-cell__value { color: var(--sb-positive); }
.sb-perf-cell--negative .sb-perf-cell__value { color: var(--sb-negative); }
.sb-perf-cell--neutral .sb-perf-cell__value { color: var(--sb-text-muted); }

.sb-perf-bar-track {
  width: 100%;
  max-width: 100px;
  height: 4px;
  background: var(--sb-bg-surface);
  border-radius: var(--sb-radius-full);
  overflow: hidden;
}
.sb-perf-bar {
  height: 100%;
  border-radius: var(--sb-radius-full);
  transition: width var(--sb-transition-base);
}
.sb-perf-bar--positive { background: var(--sb-positive); }
.sb-perf-bar--negative { background: var(--sb-negative); }
.sb-perf-bar--neutral { background: var(--sb-text-muted); }

@media (max-width: 640px) {
  .sb-market-table__change {
    min-width: 100px;
  }
  .sb-perf-bar-track { max-width: 60px; }
}

/* ===== Stories Accordion ===== */
.sb-story-toggle {
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
  margin-bottom: var(--sb-space-2);
  flex-wrap: wrap;
  cursor: pointer;
  user-select: none;
  border-radius: var(--sb-radius-md);
  padding: var(--sb-space-2) var(--sb-space-3);
  margin-left: calc(-1 * var(--sb-space-3));
  margin-right: calc(-1 * var(--sb-space-3));
  transition: background var(--sb-transition-fast);
}
.sb-story-toggle:hover {
  background: var(--sb-bg-surface);
}
.sb-story-toggle__chevron {
  color: var(--sb-text-muted);
  transition: transform var(--sb-transition-fast);
  flex-shrink: 0;
}
.sb-story-toggle.is-open .sb-story-toggle__chevron {
  transform: rotate(90deg);
}
.sb-story-content {
  display: none;
  padding-left: var(--sb-space-3);
}
.sb-story-content.is-open {
  display: block;
  animation: sb-slide-up 0.2s ease both;
}

/* ===== Stock Fundamentals Cards ===== */
.sb-fundamentals-grid {
  display: grid;
  gap: var(--sb-space-3);
}
.sb-fundamental-card {
  background: var(--sb-bg-secondary);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-lg);
  overflow: hidden;
}
.sb-fundamental-card__header {
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
  padding: var(--sb-space-3) var(--sb-space-4);
  cursor: pointer;
  transition: background 0.15s;
}
.sb-fundamental-card__header:hover {
  background: var(--sb-bg-tertiary);
}
.sb-fundamental-card__ticker {
  font-weight: var(--sb-weight-bold);
  font-size: var(--sb-text-md);
  min-width: 60px;
}
.sb-fundamental-card__company {
  color: var(--sb-text-secondary);
  font-size: var(--sb-text-sm);
  flex: 1;
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.sb-fundamental-card__metrics {
  display: flex;
  gap: var(--sb-space-2);
  flex-wrap: wrap;
}
.sb-fundamental-metric {
  font-size: var(--sb-text-xs);
  font-family: var(--sb-font-mono);
  padding: 1px 6px;
  background: var(--sb-bg-tertiary);
  border-radius: var(--sb-radius-sm);
  white-space: nowrap;
}
.sb-fundamental-card__body {
  display: none;
  padding: 0 var(--sb-space-4) var(--sb-space-4);
  font-size: var(--sb-text-sm);
  line-height: 1.6;
}
.sb-fundamental-card--expanded .sb-fundamental-card__body {
  display: block;
}
.sb-fundamental-card--expanded .sb-hf-card__chevron {
  transform: rotate(180deg);
}
.sb-fundamental-row {
  display: flex;
  gap: var(--sb-space-2);
  padding: var(--sb-space-1) 0;
  border-bottom: 1px solid var(--sb-border-light, rgba(255,255,255,0.05));
}
.sb-fundamental-row__label {
  font-weight: var(--sb-weight-semibold);
  font-size: var(--sb-text-xs);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--sb-text-muted);
  min-width: 80px;
  flex-shrink: 0;
}
.sb-fundamental-case {
  padding: var(--sb-space-2) var(--sb-space-3);
  border-radius: var(--sb-radius-md);
  font-size: var(--sb-text-xs);
  line-height: 1.5;
}
.sb-fundamental-case ul {
  margin: var(--sb-space-1) 0 0;
  padding-left: var(--sb-space-4);
}
.sb-fundamental-case li {
  margin-bottom: var(--sb-space-1);
}
.sb-fundamental-case--bull {
  background: rgba(34, 197, 94, 0.08);
  border-left: 3px solid #22c55e;
}
.sb-fundamental-case--bear {
  background: rgba(239, 68, 68, 0.08);
  border-left: 3px solid #ef4444;
}
.sb-fundamental-case__title {
  font-weight: var(--sb-weight-bold);
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: var(--sb-space-1);
}
.sb-fundamental-case--bull .sb-fundamental-case__title { color: #22c55e; }
.sb-fundamental-case--bear .sb-fundamental-case__title { color: #ef4444; }

/* ===== Time Travel Slider ===== */
.sb-time-travel {
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
}
.sb-time-travel__btn {
  background: var(--sb-bg-tertiary);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-md);
  padding: var(--sb-space-1) var(--sb-space-2);
  color: var(--sb-text-secondary);
  cursor: pointer;
  font-size: var(--sb-text-xs);
  display: flex;
  align-items: center;
  gap: var(--sb-space-1);
  transition: all 0.15s;
}
.sb-time-travel__btn:hover {
  background: var(--sb-accent);
  color: #fff;
  border-color: var(--sb-accent);
}
.sb-time-travel__panel {
  display: none;
  padding: var(--sb-space-3) 0;
  animation: sb-slide-up 0.2s ease both;
}
.sb-time-travel__panel.is-open {
  display: block;
}
.sb-time-travel__wheel-row {
  display: flex;
  align-items: center;
  gap: var(--sb-space-3);
}
.sb-time-travel__wheel-wrapper {
  position: relative;
  overflow: hidden;
  flex: 1;
  height: 60px;
  border-radius: var(--sb-radius-lg);
  background: var(--sb-bg-card);
  border: 1px solid var(--sb-border);
}
.sb-time-travel__wheel-wrapper::before,
.sb-time-travel__wheel-wrapper::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 48px;
  z-index: 2;
  pointer-events: none;
}
.sb-time-travel__wheel-wrapper::before {
  left: 0;
  background: linear-gradient(to right, var(--sb-bg-card), transparent);
}
.sb-time-travel__wheel-wrapper::after {
  right: 0;
  background: linear-gradient(to left, var(--sb-bg-card), transparent);
}
.sb-time-travel__center-mark {
  position: absolute;
  left: 50%;
  top: 0;
  bottom: 0;
  width: 2px;
  background: var(--sb-accent);
  z-index: 3;
  transform: translateX(-1px);
  opacity: 0.6;
  box-shadow: 0 0 8px var(--sb-accent);
}
.sb-time-travel__wheel {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  scrollbar-width: none;
  -ms-overflow-style: none;
  height: 100%;
  align-items: center;
}
.sb-time-travel__wheel::-webkit-scrollbar {
  display: none;
}
.sb-time-travel__date-cell {
  scroll-snap-align: center;
  min-width: 68px;
  flex-shrink: 0;
  text-align: center;
  padding: 6px 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  border-radius: var(--sb-radius-md);
  user-select: none;
}
.sb-time-travel__date-cell:hover {
  background: var(--sb-bg-surface);
}
.sb-time-travel__date-day {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--sb-text-muted);
  line-height: 1.4;
}
.sb-time-travel__date-num {
  font-size: var(--sb-text-sm);
  font-weight: var(--sb-weight-semibold);
  color: var(--sb-text-secondary);
  font-family: var(--sb-font-mono);
  line-height: 1.3;
}
.sb-time-travel__date-cell.is-selected {
  background: var(--sb-accent);
  transform: scale(1.08);
}
.sb-time-travel__date-cell.is-selected .sb-time-travel__date-day,
.sb-time-travel__date-cell.is-selected .sb-time-travel__date-num {
  color: #fff;
}
.sb-time-travel__date-cell.is-today .sb-time-travel__date-day {
  color: var(--sb-accent);
  font-weight: var(--sb-weight-bold);
}
.sb-time-travel__go {
  background: var(--sb-accent);
  color: #fff;
  border: none;
  border-radius: var(--sb-radius-md);
  padding: var(--sb-space-2) var(--sb-space-4);
  font-size: var(--sb-text-xs);
  font-weight: var(--sb-weight-semibold);
  cursor: pointer;
  white-space: nowrap;
}
.sb-time-travel__go:hover {
  filter: brightness(1.15);
}
.sb-time-travel__close {
  background: none;
  border: none;
  color: var(--sb-text-muted);
  cursor: pointer;
  padding: var(--sb-space-1);
  font-size: 18px;
}

/* ===== Deep Dive Modal ===== */
.sb-deep-dive-btn {
  background: none;
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-md);
  padding: 3px 6px;
  cursor: pointer;
  color: var(--sb-text-muted);
  transition: all 0.15s;
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: var(--sb-text-xs);
}
.sb-deep-dive-btn:hover {
  background: var(--sb-accent);
  color: #fff;
  border-color: var(--sb-accent);
}
.sb-deep-dive-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--sb-space-6);
  animation: sb-fade-in 0.2s ease;
}
@keyframes sb-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}
.sb-deep-dive-modal {
  background: var(--sb-bg-primary);
  border: 1px solid var(--sb-border);
  border-radius: var(--sb-radius-xl, 16px);
  max-width: 700px;
  width: 100%;
  max-height: 80vh;
  overflow-y: auto;
  padding: var(--sb-space-6);
  position: relative;
}
.sb-deep-dive-modal__close {
  position: absolute;
  top: var(--sb-space-3);
  right: var(--sb-space-3);
  background: none;
  border: none;
  color: var(--sb-text-muted);
  cursor: pointer;
  font-size: 20px;
  padding: var(--sb-space-1);
}
.sb-deep-dive-modal__title {
  font-size: var(--sb-text-lg);
  font-weight: var(--sb-weight-bold);
  margin-bottom: var(--sb-space-4);
  padding-right: var(--sb-space-8);
}
.sb-deep-dive-modal__content {
  font-size: var(--sb-text-sm);
  line-height: 1.8;
  color: var(--sb-text-secondary);
  white-space: pre-line;
}
.sb-deep-dive-modal__loading {
  display: flex;
  align-items: center;
  gap: var(--sb-space-2);
  color: var(--sb-text-muted);
  font-size: var(--sb-text-sm);
}
.sb-deep-dive-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid var(--sb-border);
  border-top-color: var(--sb-accent);
  border-radius: 50%;
  animation: sb-spin 0.8s linear infinite;
}
@keyframes sb-spin {
  to { transform: rotate(360deg); }
}
